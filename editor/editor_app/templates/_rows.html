<!-- app/templates/_rows.html -->
<div class="p-0">
  <div class="border-b px-3 py-2 flex items-center justify-between">
    <div class="text-sm text-neutral-600">
      {{ total }} risultati • pagina {{ page }} di {{ pages }}
    </div>
    <div class="flex items-center gap-2">
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ 1 }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page<=1 %}disabled{% endif %}
      >« Prima</button>
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ page-1 }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page<=1 %}disabled{% endif %}
      >‹ Indietro</button>
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ page+1 }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page>=pages %}disabled{% endif %}
      >Avanti ›</button>
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ pages }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page>=pages %}disabled{% endif %}
      >Ultima »</button>
    </div>
  </div>

  {% if items %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {% for it in items %}
        <div class="border rounded-lg p-3 hover:bg-gray-50">
          <a class="block" href="/show/{{ collection }}/{{ it._id }}{% if qs %}?{{ qs }}{% endif %}" aria-label="Apri documento {{ it._id }}">
            <div class="text-sm font-medium truncate">
              {{ it.name or it.term or it.title or '(senza titolo)' }}
            </div>
            <div class="text-xs text-neutral-500 mono truncate">{{ it._id }}</div>
          </a>
          <a class="btn btn-primary mt-2" href="/edit_raw/{{ collection }}/{{ it._id }}{% if qs %}?{{ qs }}{% endif %}" aria-label="Modifica documento {{ it._id }} in JSON">Modifica</a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="px-3 py-6 text-center text-sm text-neutral-600">
      Nessun risultato. Prova a cambiare i termini di ricerca.
    </div>
  {% endif %}

  <div class="border-t px-3 py-2 flex items-center justify-between">
    <div class="text-xs text-neutral-500">Mostrati {{ items|length }} elementi</div>
    <div class="flex items-center gap-2">
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ page-1 }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page<=1 %}disabled{% endif %}
      >‹ Indietro</button>
      <span class="text-sm">Pag. {{ page }}/{{ pages }}</span>
      <button
        class="btn btn-ghost"
        hx-get="/view/{{ collection }}?page={{ page+1 }}&page_size={{ page_size }}&q={{ q|urlencode }}"
        hx-target="#rows" hx-include="#search-form"
        {% if page>=pages %}disabled{% endif %}
      >Avanti ›</button>
    </div>
  </div>
</div>
