{{define "title"}}{{.title}}{{end}}

{{define "content"}}
<div class="notion-page">
  <div class="notion-page-header">
    <h1 style="color: var(--notion-text); font-size: 2rem; font-weight: 600; margin: 0;">
      {{.title}}
    </h1>
    <p style="color: var(--notion-text-light); margin-top: 0.5rem;">
      Gestione del sistema D&D 5e SRD
    </p>
  </div>

  <!-- Statistics Overview -->
  <div class="notion-section" style="margin-bottom: 2rem;">
    <h2 style="color: var(--notion-text); font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">
      Statistiche Generali
    </h2>
    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
      <div class="stat-card">
        <h3>Elementi Totali</h3>
        <p class="stat-number">{{.stats.total_items}}</p>
      </div>
      <div class="stat-card">
        <h3>Collezioni</h3>
        <p class="stat-number">{{len .stats.collections}}</p>
      </div>
      <div class="stat-card">
        <h3>Versione</h3>
        <p class="stat-text">3.0.0-go</p>
      </div>
      <div class="stat-card">
        <h3>Architettura</h3>
        <p class="stat-text">Esagonale</p>
      </div>
    </div>
  </div>

  <!-- Collections Overview -->
  <div class="notion-section" style="margin-bottom: 2rem;">
    <h2 style="color: var(--notion-text); font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">
      Collezioni
    </h2>
    <div class="collection-stats">
      {{range $collection, $count := .stats.collections}}
      <div class="collection-stat-row">
        <span class="collection-name">{{capitalize $collection}}</span>
        <span class="collection-count">{{$count}} elementi</span>
        <a href="/{{$collection}}" class="btn btn-small btn-ghost">Visualizza</a>
      </div>
      {{end}}
    </div>
  </div>

  <!-- Admin Actions -->
  <div class="notion-section">
    <h2 style="color: var(--notion-text); font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">
      Azioni
    </h2>
    <div class="admin-actions" style="display: flex; flex-wrap: wrap; gap: 1rem;">
      <a href="/admin/collections" class="btn btn-secondary">
        Gestisci Collezioni
      </a>
      <button hx-post="/admin/sync" 
              hx-target="#sync-result"
              hx-indicator="#sync-loading"
              class="btn btn-primary">
        Sincronizza Dati
      </button>
      <a href="/health" class="btn btn-ghost" target="_blank">
        Health Check
      </a>
    </div>
    
    <div id="sync-loading" class="htmx-indicator" style="margin-top: 1rem;">
      <span class="spinner"></span> Sincronizzazione in corso...
    </div>
    
    <div id="sync-result" style="margin-top: 1rem;"></div>
  </div>
</div>

<style>
.stats-grid {
  gap: 1rem;
}

.stat-card {
  background: var(--notion-card-bg);
  border: 1px solid var(--notion-border);
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;
}

.stat-card h3 {
  color: var(--notion-text-light);
  font-size: 0.875rem;
  font-weight: 500;
  margin: 0 0 0.5rem 0;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.stat-number {
  color: var(--notion-text);
  font-size: 2rem;
  font-weight: 700;
  margin: 0;
}

.stat-text {
  color: var(--notion-text);
  font-size: 1.25rem;
  font-weight: 600;
  margin: 0;
}

.collection-stats {
  background: var(--notion-card-bg);
  border: 1px solid var(--notion-border);
  border-radius: 8px;
  overflow: hidden;
}

.collection-stat-row {
  display: flex;
  align-items: center;
  padding: 1rem 1.5rem;
  border-bottom: 1px solid var(--notion-border);
}

.collection-stat-row:last-child {
  border-bottom: none;
}

.collection-name {
  flex: 1;
  font-weight: 500;
  color: var(--notion-text);
}

.collection-count {
  color: var(--notion-text-light);
  margin-right: 1rem;
  font-size: 0.875rem;
}

.admin-actions {
  margin-top: 1rem;
}

.btn-small {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
}

.htmx-indicator {
  display: none;
}

.htmx-request .htmx-indicator {
  display: flex;
  align-items: center;
  color: var(--notion-text-light);
}

.htmx-request .htmx-indicator .spinner {
  margin-right: 0.5rem;
}
</style>
{{end}}