{{define "rows"}}
<div class="divide-y">
  {{range .documents}}
    {{$doc_name := .nome}}{{if eq $doc_name ""}}{{$doc_name = .name}}{{end}}{{if eq $doc_name ""}}{{$doc_name = .title}}{{end}}{{if eq $doc_name ""}}{{$doc_name = .titolo}}{{end}}{{if eq $doc_name ""}}{{$doc_name = .slug}}{{end}}
    {{$doc_slug := .slug}}{{if eq $doc_slug ""}}{{$doc_slug = .id}}{{end}}{{if eq $doc_slug ""}}{{$doc_slug = .nome}}{{end}}{{if eq $doc_slug ""}}{{$doc_slug = .name}}{{end}}{{if eq $doc_slug ""}}{{$doc_slug = ._id}}{{end}}
    
    <a href="/{{$.collection}}/{{$doc_slug}}{{if $.qs}}?{{$.qs}}{{end}}" 
       class="block px-4 py-3 hover:bg-neutral-50 text-inherit no-underline"
       hx-get="/{{$.collection}}/{{$doc_slug}}"
       hx-target="#page-root"
       hx-select="#page-root"
       hx-swap="outerHTML"
       hx-push-url="true"
       hx-indicator="#page-loading">
      <div class="flex items-center justify-between">
        <div class="flex-1">
          <h3 class="font-medium text-gray-900">
            {{$doc_name}}
          </h3>
          
          <div class="text-xs text-neutral-500 mt-1 flex flex-wrap items-center gap-2">
            {{/* Incantesimi - Level + School */}}
            {{if .level}}
              <span>Livello {{.level}}</span>
            {{else if .livello}}
              <span>Livello {{.livello}}</span>
            {{end}}
            {{if .school}}
              <span>{{.school}}</span>
            {{else if .scuola}}
              <span>{{.scuola}}</span>
            {{end}}
            
            {{/* Oggetti magici - Rarity + Type */}}
            {{if .rarity}}
              <span>{{.rarity}}</span>
            {{else if .rarita}}
              <span>{{.rarita}}</span>
            {{end}}
            {{if .type}}
              <span>{{.type}}</span>
            {{else if .tipo}}
              <span>{{.tipo}}</span>
            {{end}}
            
            {{/* Mostri - Size + Type + CR */}}
            {{if .size}}
              <span>{{.size}}</span>
            {{else if .taglia}}
              <span>{{.taglia}}</span>
            {{end}}
            {{if .challenge_rating}}
              <span>GS {{.challenge_rating}}</span>
            {{else if .cr}}
              <span>GS {{.cr}}</span>
            {{else if .gs}}
              <span>GS {{.gs}}</span>
            {{else if .grado_sfida}}
              <span>GS {{.grado_sfida}}</span>
            {{end}}
            
            {{/* Armi - Category + Damage */}}
            {{if .category}}
              <span>{{.category}}</span>
            {{else if .categoria}}
              <span>{{.categoria}}</span>
            {{end}}
            {{if .damage}}
              <span>{{.damage}}</span>
            {{else if .danno}}
              <span>{{.danno}}</span>
            {{end}}
            
            {{/* Armature - Category + AC */}}
            {{if .ac_base}}
              <span>CA {{.ac_base}}</span>
            {{else if .ca_base}}
              <span>CA {{.ca_base}}</span>
            {{end}}
            
            {{/* Altri campi generici */}}
            {{if .cost}}
              <span>{{.cost}}</span>
            {{else if .costo}}
              <span>{{.costo}}</span>
            {{end}}
            {{if .weight}}
              <span>{{.weight}}</span>
            {{else if .peso}}
              <span>{{.peso}}</span>
            {{end}}
          </div>
        </div>
        
        {{if .translated}}
        <div class="text-xs text-green-600">
          ✓ Tradotto
        </div>
        {{end}}
      </div>
    </a>
  {{end}}
  
  {{if not .documents}}
    <div class="px-4 py-8 text-center text-neutral-500">
      <p>Nessun documento trovato.</p>
    </div>
  {{end}}
</div>

{{/* Pagination */}}
{{if gt .total .page_size}}
<div class="px-4 py-3 border-t bg-neutral-50">
  <div class="flex items-center justify-between text-sm text-neutral-600">
    <div>
      Documenti {{.start_item}}-{{.end_item}} di {{.total}}
    </div>
    
    <div class="flex items-center space-x-2">
      {{if .has_prev}}
        <button hx-get="/{{.collection}}/rows?page={{sub .page 1}}{{if .qs}}&{{.qs}}{{end}}"
                hx-target="#rows"
                class="px-3 py-1 bg-white border rounded hover:bg-neutral-50">
          ← Precedente
        </button>
      {{end}}
      
      <span class="px-2">Pagina {{.page}} di {{.total_pages}}</span>
      
      {{if .has_next}}
        <button hx-get="/{{.collection}}/rows?page={{add .page 1}}{{if .qs}}&{{.qs}}{{end}}"
                hx-target="#rows"
                class="px-3 py-1 bg-white border rounded hover:bg-neutral-50">
          Successiva →
        </button>
      {{end}}
    </div>
  </div>
</div>
{{end}}
{{end}}